##### Uses the  >AMS2019 inputfile format (indicated by the AMS and AMS END keys)
##### You must load the ams (>2019) module

JOBSUB

#!/bin/bash
#SBATCH -N 1
#SBATCH -t 12:00:00
#SBATCH --ntasks-per-node=32
#SBATCH --partition=tc

echo "== Starting run at $(date)"
echo "== Job ID: ${SLURM_JOBID}"
echo "== Node list: ${SLURM_NODELIST}"
echo "== Submit dir. : ${SLURM_SUBMIT_DIR}"
echo "== Scratch dir. : ${TMPDIR}"

# TC
module load shared
module load ams/2025.103
export SCM_TMPDIR="/scratch/${SLURM_JOBID}"
srun mkdir -p ${SCM_TMPDIR}
srun chmod 733 ${SCM_TMPDIR}

# Snellius
# module load 2022
# module load AMS/2023.101-intelmpi
# module list

[postamble]
srun rm -rf ${SCM_TMPDIR}

JOBSUB END


PyFrag
name new_ams_job
coordfile $SLURM_SUBMIT_DIR/*xyz
frag1_indices  2 # Put here the atom indices of the first fragment (start with 1)
frag2_indices  1 3-6 # Put here the atom indices of the second fragment (start with 1)
frag1_energy    0 # Put here the (optimized) energy of the first fragment (in kcal/mol)
frag2_energy   -554.09 # Put here the (optimized) energy of the second fragment (in kcal/mol)

bondlength 1 6 1.133
bondlength 1 2 2.257

angle 2 1 6

vdd 2 6

overlap frag1 HOMO frag2 LUMO
overlap frag2 HOMO frag1 LUMO

orbitalenergy frag1 HOMO
orbitalenergy frag1 LUMO
orbitalenergy frag2 HOMO
orbitalenergy frag2 LUMO

population frag1 HOMO
population frag1 LUMO
population frag2 HOMO
population frag2 LUMO


PyFrag END

AMS

Task SinglePoint

Engine adf
  basis
    core Small
    type TZ2P
  End

  eprint
    sfo EIG OVL
  End

  numericalquality Normal

  xc
    gga OPBE
  End
EndEngine

AMS END